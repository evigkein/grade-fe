import{a as Q}from"./chunk-SDIPWAR3.js";import{a as Nt}from"./chunk-Y76QHX2X.js";import{c as Ft,e as ct}from"./chunk-AYPZRFPW.js";import{b as At}from"./chunk-DUNFNXGG.js";import{a as zt}from"./chunk-CNF6XKAQ.js";import{i as Rt,j as Lt,l as at,n as Tt,o as kt}from"./chunk-SSN7TVEG.js";import{b as Vt,c as E}from"./chunk-GSX75BF4.js";import{Ad as Dt,Ba as w,C as g,E as k,F as G,I as J,Ia as I,Kb as Mt,La as z,Ma as gt,Mb as Ot,Na as $,Q as x,R as tt,Ra as M,Tb as ot,U as mt,Ub as rt,Z as ut,_ as ht,a as U,aa as et,ac as st,ba as F,bb as l,be as S,cb as p,db as m,de as V,ea as u,eb as O,ec as yt,fa as h,gc as v,hc as D,ib as _t,jb as wt,jd as Pt,l as K,la as nt,lb as y,nb as _,nc as St,ob as a,oc as H,pa as dt,pb as vt,qb as Ct,ra as N,rb as bt,sb as it,tb as B,ub as j,uc as Et,v as pt,va as ft,wb as xt,x as f,xb as It,yc as W,za as c}from"./chunk-CJOHU5ML.js";var C=class C{};C.\u0275fac=function(e){return new(e||C)},C.\u0275mod=gt({type:C}),C.\u0275inj=ht({imports:[W,S]});var $t=C;var b=class b{constructor(t,e){this.api=t;this.state=e}get(t=""){let e=this.key(t),n=this.state.get(e,null);return n?(V||this.state.remove(e),pt(n)):this.api.locationsApiControllerFind({body:{name:t}}).pipe(f(i=>i?.data??[]),mt(i=>{V()&&this.state.set(e,i)}))}key(t){let e=(t??"").trim().toLowerCase();return`locations:${e}`}};b.\u0275fac=function(e){return new(e||b)(et(Q),et(ft))},b.\u0275prov=ut({token:b,factory:b.\u0275fac,providedIn:"root"});var Y=b;var Jt=(r,t)=>({from:r,to:t});function te(r,t){if(r&1){let e=y();_t(0),p(1,"form",1)(2,"p-select",2),_("search",function(i){u(e);let o=a();return h(o.onSearchFrom(i))}),m(),O(3,"p-icon",3),p(4,"p-select",4),_("search",function(i){u(e);let o=a();return h(o.onSearchTo(i))}),m(),p(5,"p-button",5),_("action",function(){u(e);let i=a();return h(i.onSubmit())}),m()(),wt()}if(r&2){let e=t.ngIf,n=a();c(2),l("formControl",n.fromControl)("options",e.from),c(2),l("formControl",n.toControl)("options",e.to)}}var P=class P{constructor(){this.pickRoute=new w;this.apiLocations=F(Q);this.notify=At();this.destroy$=E();this.locationsTransfer=F(Y);this.fromControl=new at(null);this.toControl=new at(null);this.fromQuery$=new K;this.toQuery$=new K;this.route=F(Pt);this.slugs=Dt(this.route.paramMap);this.locationsFrom$=this.fromQuery$.pipe(x(""),f(t=>t?.trim()??""),ct(),tt(t=>this.fetchLocations(t)),f(t=>this.applyPreset(t,0)));this.locationsTo$=this.toQuery$.pipe(x(""),f(t=>t?.trim()??""),ct(),tt(t=>this.fetchLocations(t)),f(t=>this.applyPreset(t,1)))}ngOnInit(){}ngOnChanges(t){if(!t.initLocations.firstChange)return;let e=t.initLocations?.currentValue;!e||!Array.isArray(e)||e.length===0||(e[0]&&this.fromControl.setValue(e[0],{emitEvent:!0}),e[1]&&this.toControl.setValue(e[1],{emitEvent:!0}))}onSearchFrom(t){this.fromQuery$.next(t)}onSearchTo(t){this.toQuery$.next(t)}onSubmit(){let t=this.fromControl.value,e=this.toControl.value,n=this.slugs().get("slug")?.split("_");if(!(n?.length===2&&t?.slug===n[0]&&e?.slug===n[1])){if(!t||!e){let i="";e||(i="\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043B\u043E\u043A\u0430\u0446\u0438\u044E \u043D\u0430\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F"),t||(i="\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043B\u043E\u043A\u0430\u0446\u0438\u044E \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F"),this.notify.showError(i);return}if(t?.slug===e?.slug){this.notify.showError("\u041F\u0443\u043D\u043A\u0442\u044B \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u0438 \u043D\u0430\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u044B \u0441\u043E\u0432\u043F\u0430\u0434\u0430\u0442\u044C");return}this.pickRoute.emit([t,e])}}fetchLocations(t){return this.locationsTransfer.get(t).pipe(f(e=>e.map(n=>({label:n.name,value:n}))))}applyPreset(t,e){let n=this.initLocations?.[e];if(!n)return t;let i=t.findIndex(o=>o.value.slug===n.slug);return i===-1?t.push({label:n.name,value:n}):t.splice(i,1,{label:n.name,value:n}),t}};P.\u0275fac=function(e){return new(e||P)},P.\u0275cmp=z({type:P,selectors:[["p-route-filter"]],inputs:{initSlugs:"initSlugs",initLocations:"initLocations"},outputs:{pickRoute:"pickRoute"},features:[dt],decls:3,vars:8,consts:[[4,"ngIf"],[1,"route__filter"],["size","l","placeholder","\u041E\u0442\u043A\u0443\u0434\u0430","isMaxHeight","","isSearchable","","isServerSearch","",3,"search","formControl","options"],["icon","doubleArrows","size","34"],["size","l","placeholder","\u041A\u0443\u0434\u0430","isMaxHeight","","isSearchable","","isServerSearch","",3,"search","formControl","options"],["type","primary","isHeightInherit","","label","\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C",3,"action"]],template:function(e,n){e&1&&(M(0,te,6,4,"ng-container",0),ot(1,"async"),ot(2,"async")),e&2&&l("ngIf",Ot(5,Jt,rt(1,1,n.locationsFrom$),rt(2,3,n.locationsTo$)))},dependencies:[W,H,Ft,Nt,Tt,Rt,Lt,kt,S,Vt,Et],styles:["[_nghost-%COMP%]{width:100%;display:flex;align-items:center;gap:8px}@media (max-width: 650px){[_nghost-%COMP%]{flex-wrap:wrap;row-gap:10px}[_nghost-%COMP%]   p-select[_ngcontent-%COMP%]{min-width:140px}[_nghost-%COMP%]   p-icon[_ngcontent-%COMP%]{order:0}[_nghost-%COMP%]   p-button[_ngcontent-%COMP%]{order:99;margin-left:0;width:100%;flex:0 0 100%;height:56px}}@media (max-width: 400px){[_nghost-%COMP%]   p-select[_ngcontent-%COMP%]{width:100px;min-width:auto}}p-button[_ngcontent-%COMP%]{margin-left:4px;height:60px;display:inline-flex;align-items:center}p-select[_ngcontent-%COMP%]{flex:1 1 auto;min-width:140px}p-icon[_ngcontent-%COMP%]{flex:0 0 auto;line-height:0}.route__filter[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:8px;flex-wrap:nowrap;min-width:140px}@media (max-width: 650px){.route__filter[_ngcontent-%COMP%]{flex-wrap:wrap;flex-direction:column;row-gap:10px}.route__filter[_ngcontent-%COMP%]   p-select[_ngcontent-%COMP%]{width:100%}.route__filter[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{height:56px}.route__filter[_ngcontent-%COMP%]   p-icon[_ngcontent-%COMP%]{display:none}}"],changeDetection:0});var Bt=P;var R=class R{constructor(t){this.el=t}};R.\u0275fac=function(e){return new(e||R)(I(N))},R.\u0275dir=$({type:R,selectors:[["","pCarouselItem",""]]});var X=R;var jt={childList:!0,attributes:!0,characterData:!0,subtree:!0};function Ht(r,t,e=jt){if(typeof MutationObserver>"u")return null;let n=U(U({},jt),e),i=new MutationObserver(t);return i.observe(r,n),i}var Wt=1e3,Qt=30,Yt=3,Xt={coord:[0,0],time:0};var L=class L{constructor(t){this.el=t;this.hasMouseHandling=!1;this.isDesktopSwipe=!1;this.swipeRight=new w;this.swipeLeft=new w;this.swipeData=Xt;this.destroy$=E()}ngOnInit(){this.initHandlingSwipes()}handleSwipeStart(t){let e="touches"in t?[t.touches[0].clientX,t.touches[0].clientY]:[t.clientX,t.clientY],n=Date.now();this.startSwipe(e,n)}handleSwipeEnd(t){let e="changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[t.clientX,t.clientY],n=Date.now();this.endSwipe(e,n)}startSwipe(t,e){this.swipeData={coord:t,time:e}}endSwipe(t,e){let n=[t[0]-this.swipeData.coord[0],t[1]-this.swipeData.coord[1]],i=e-this.swipeData.time;this.isSwipeAction(n,i)&&(n[0]<0?this.swipeRight.emit():this.swipeLeft.emit())}isSwipeAction(t,e){let[n,i]=t,o=Math.abs(n)>Qt,s=Math.abs(n)>Math.abs(i*Yt),d=e<Wt;return o&&s&&d}initHandlingSwipes(){let t=g(this.el.nativeElement,"touchstart"),e=g(this.el.nativeElement,"touchend"),n=g(this.el.nativeElement,"mousedown").pipe(G(()=>this.hasMouseHandling||this.isDesktopSwipe)),i=g(this.el.nativeElement,"mouseup").pipe(G(()=>this.hasMouseHandling||this.isDesktopSwipe));k(t,n).pipe(this.destroy$()).subscribe(o=>this.handleSwipeStart(o)),k(e,i).pipe(this.destroy$()).subscribe(o=>this.handleSwipeEnd(o))}};L.\u0275fac=function(e){return new(e||L)(I(N))},L.\u0275dir=$({type:L,selectors:[["","swipe",""]],inputs:{hasMouseHandling:"hasMouseHandling",isDesktopSwipe:[2,"isDesktopSwipe","isDesktopSwipe",v]},outputs:{swipeRight:"swipeRight",swipeLeft:"swipeLeft"}});var Z=L;var ne=["outer"],ie=["inner"],oe=["*"],re=()=>[];function se(r,t){if(r&1){let e=y();p(0,"button",9),_("click",function(){u(e);let i=a(2);return h(i.move(i.SCROLL_DIRECTION.Backward))}),O(1,"p-icon",10),m()}}function ae(r,t){if(r&1){let e=y();p(0,"button",11),_("click",function(){u(e);let i=a(2);return h(i.move(i.SCROLL_DIRECTION.Forward))}),O(1,"p-icon",12),m()}}function ce(r,t){if(r&1&&(p(0,"div",6),M(1,se,2,0,"button",7)(2,ae,2,0,"button",8),m()),r&2){let e=a();c(),l("ngIf",e.isArrowBackShown),c(),l("ngIf",e.isArrowForwardShown)}}function le(r,t){if(r&1&&O(0,"div",15),r&2){let e=t.index,n=a(2);It("carousel-dots__dot--active",e===n.currentPage())}}function pe(r,t){if(r&1&&(p(0,"div",13),M(1,le,1,2,"div",14),m()),r&2){let e=a();c(),l("ngForOf",Mt(2,re).constructor(e.dotsCount()))("ngForTrackBy",e.trackBy)}}var qt=(e=>(e.Backward="backward",e.Forward="forward",e))(qt||{}),T=class T{constructor(t){this.cdr=t;this.minItemWidth=280;this.gap=16;this.autoplay=!1;this.dots=!1;this.alignItems=!0;this.hasButtons=!0;this.indexChange=new w;this.SCROLL_DIRECTION=qt;this.isArrowBackShown=!1;this.isArrowForwardShown=!1;this.destroy$=E();this.itemsPerView=nt(1);this.currentIndex=nt(0);this.currentPage=st(()=>{let t=Math.max(1,this.itemsPerView()),e=Math.max(0,this.items?.length??0),n=this.currentIndex();return Math.min(Math.floor(n/t+1e-4),Math.ceil(e/t)-1)});this.trackBy=zt;this.dotsCount=st(()=>{let t=this.items?.length??0,e=this.itemsPerView();return t?Math.ceil(t/e):0})}ngAfterViewInit(){this.observeResize(),this.observeMutations(),g(this.outerRef.nativeElement,"scroll").pipe(J(60),x(null),this.destroy$()).subscribe(()=>this.onScrolled()),setTimeout(()=>this.reflow(),0)}move(t){let e=Math.max(0,this.items.length-this.itemsPerView());t==="forward"?this.currentIndex.set(Math.min(e,this.currentIndex()+this.itemsPerView())):this.currentIndex.set(Math.max(0,this.currentIndex()-this.itemsPerView())),this.scrollToIndex(this.currentIndex())}resetScrollPosition(){this.currentIndex.set(0),this.scrollToIndex(0)}reflow(){let t=this.outerRef.nativeElement,e=this.innerRef.nativeElement,n=t.clientWidth,i=this.items.length||1,o=this.gap*Math.max(0,this.itemsPerView()-1),s;this.itemWidth&&this.itemWidth>0?s=Math.max(1,Math.floor((n+this.gap)/(this.itemWidth+this.gap))):s=Math.max(1,Math.floor((n+this.gap)/(this.minItemWidth+this.gap))),this.maxItemsInView&&this.maxItemsInView>0&&(s=Math.min(s,this.maxItemsInView)),s=Math.min(s,i);let d=Math.floor((n-this.gap*(s-1))/s);this.items.forEach(Ut=>{let q=Ut.el.nativeElement;q.style.flex=`0 0 ${d}px`,q.style.minWidth=`${d}px`,q.style.maxWidth=`${d}px`}),e.style.gap=`${this.gap}px`,this.itemsPerView.set(s);let lt=Math.max(0,i-this.itemsPerView());this.currentIndex()>lt&&this.currentIndex.set(lt),this.scrollToIndex(this.currentIndex(),!1),this.updateButtons(),this.cdr.markForCheck()}scrollToIndex(t,e=!0){if(!V())return;let n=this.outerRef.nativeElement,i=this.items?.get(t)?.el.nativeElement;if(!i)return;let o=i.offsetLeft-this.innerRef.nativeElement.offsetLeft;n.scrollTo({left:o,behavior:e?"smooth":"auto"}),this.indexChange.emit(t),this.updateButtons()}onScrolled(){let t=this.outerRef.nativeElement.scrollLeft,e=0,n=Number.MAX_VALUE;this.items.forEach((i,o)=>{let s=i.el.nativeElement.offsetLeft-this.innerRef.nativeElement.offsetLeft,d=Math.abs(t-s);d<n&&(n=d,e=o)}),e!==this.currentIndex()&&(this.currentIndex.set(e),this.indexChange.emit(e)),this.updateButtons()}updateButtons(){let t=Math.max(0,(this.items?.length||0)-this.itemsPerView());this.isArrowBackShown=this.currentIndex()>0,this.isArrowForwardShown=this.currentIndex()<t,this.cdr.markForCheck()}observeResize(){if(typeof window>"u")return;let t=()=>this.reflow();this.resizeOuter=new ResizeObserver(t),this.resizeOuter.observe(this.outerRef.nativeElement),this.resizeInner=new ResizeObserver(t),this.resizeInner.observe(this.innerRef.nativeElement),g(window,"orientationchange").pipe(this.destroy$()).subscribe(t)}observeMutations(){this.mutation=Ht(this.innerRef.nativeElement,()=>this.reflow()),k(this.items.changes).pipe(x(null),J(0),this.destroy$()).subscribe(()=>this.reflow())}ngOnDestroy(){this.resizeOuter?.disconnect(),this.resizeInner?.disconnect(),this.mutation?.disconnect()}};T.\u0275fac=function(e){return new(e||T)(I(yt))},T.\u0275cmp=z({type:T,selectors:[["p-carousel"]],contentQueries:function(e,n,i){if(e&1&&bt(i,X,5),e&2){let o;B(o=j())&&(n.items=o)}},viewQuery:function(e,n){if(e&1&&(it(ne,7),it(ie,7)),e&2){let i;B(i=j())&&(n.outerRef=i.first),B(i=j())&&(n.innerRef=i.first)}},inputs:{minItemWidth:[2,"minItemWidth","minItemWidth",D],gap:[2,"gap","gap",D],itemWidth:[2,"itemWidth","itemWidth",D],autoplay:[2,"autoplay","autoplay",v],dots:[2,"dots","dots",v],maxItemsInView:[2,"maxItemsInView","maxItemsInView",D],alignItems:[2,"alignItems","alignItems",v],hasButtons:[2,"hasButtons","hasButtons",v]},outputs:{indexChange:"indexChange"},standalone:!1,ngContentSelectors:oe,decls:7,vars:4,consts:[["outer",""],["inner",""],[1,"carousel-outer","carousel-outer--scrollable","hide-scrollbar"],["swipe","","isDesktopSwipe","",1,"carousel-inner",3,"swipeLeft","swipeRight"],["class","buttons",4,"ngIf"],["class","carousel-dots",4,"ngIf"],[1,"buttons"],["class","buttons__backward",3,"click",4,"ngIf"],["class","buttons__forward",3,"click",4,"ngIf"],[1,"buttons__backward",3,"click"],["icon","angleLeft"],[1,"buttons__forward",3,"click"],["icon","angleRight"],[1,"carousel-dots"],["class","carousel-dots__dot",3,"carousel-dots__dot--active",4,"ngFor","ngForOf","ngForTrackBy"],[1,"carousel-dots__dot"]],template:function(e,n){if(e&1){let i=y();vt(),p(0,"div",2,0)(2,"div",3,1),_("swipeLeft",function(){return u(i),h(n.move(n.SCROLL_DIRECTION.Backward))})("swipeRight",function(){return u(i),h(n.move(n.SCROLL_DIRECTION.Forward))}),Ct(4),m()(),M(5,ce,3,2,"div",4)(6,pe,2,3,"div",5)}e&2&&(c(2),xt("gap",n.gap,"px"),c(3),l("ngIf",n.hasButtons),c(),l("ngIf",n.dots&&n.dotsCount()>1))},dependencies:[St,H,S,Z],styles:[".buttons[_ngcontent-%COMP%]{position:absolute;inset:0;pointer-events:none;z-index:3}.buttons__backward[_ngcontent-%COMP%], .buttons__forward[_ngcontent-%COMP%]{width:36px;height:36px;position:absolute;top:50%;transform:translateY(-50%);cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;box-shadow:0 2px 6px #0000001a;transition:opacity .3s ease,transform .25s ease;z-index:2;pointer-events:auto;background:#fff}.buttons__backward[_ngcontent-%COMP%]:hover, .buttons__forward[_ngcontent-%COMP%]:hover{background:#fff;transform:translateY(-50%) scale(1.05)}.buttons__backward[_ngcontent-%COMP%]   p-icon[_ngcontent-%COMP%], .buttons__forward[_ngcontent-%COMP%]   p-icon[_ngcontent-%COMP%]{width:18px;height:18px;color:#ff5100}.buttons__backward[_ngcontent-%COMP%]{left:8px}.buttons__forward[_ngcontent-%COMP%]{right:8px}.buttons[_ngcontent-%COMP%]   button.ng-leave[_ngcontent-%COMP%], .buttons[_ngcontent-%COMP%]   button.ng-enter[_ngcontent-%COMP%]{transition:opacity .3s ease}[_nghost-%COMP%]{position:relative}.carousel-outer[_ngcontent-%COMP%]{width:100%;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;scroll-snap-type:x mandatory}.carousel-inner[_ngcontent-%COMP%]{display:inline-flex;gap:16px;touch-action:pan-y!important}.carousel-inner[_ngcontent-%COMP%] > *[pCarouselItem][_ngcontent-%COMP%]{scroll-snap-align:start;flex:0 0 auto}.buttons--disabled[_ngcontent-%COMP%]{color:var(--hover-common)}.buttons__backward[_ngcontent-%COMP%]{width:36px;height:36px;position:absolute;top:50%;transform:translateY(-50%);cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;box-shadow:0 2px 6px #0000001a;transition:opacity .3s ease,transform .25s ease;z-index:2;left:0}.buttons__backward[_ngcontent-%COMP%]:hover{background:#fff;transform:translateY(-50%) scale(1.05)}.buttons__backward[_ngcontent-%COMP%]   p-icon[_ngcontent-%COMP%]{width:18px;height:18px;color:#ff5100}.buttons__forward[_ngcontent-%COMP%]{width:36px;height:36px;position:absolute;top:50%;transform:translateY(-50%);cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;box-shadow:0 2px 6px #0000001a;transition:opacity .3s ease,transform .25s ease;z-index:2;right:8px}.buttons__forward[_ngcontent-%COMP%]:hover{background:#fff;transform:translateY(-50%) scale(1.05)}.buttons__forward[_ngcontent-%COMP%]   p-icon[_ngcontent-%COMP%]{width:18px;height:18px;color:#ff5100}.carousel-dots[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;align-self:center;justify-self:center;gap:8px;z-index:2}.carousel-dots__dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#dcdcdc;transform-origin:center center;transition:width .45s cubic-bezier(.4,0,.2,1),background-color .45s cubic-bezier(.4,0,.2,1),background-image .45s cubic-bezier(.4,0,.2,1),border-radius .45s cubic-bezier(.4,0,.2,1),transform .45s cubic-bezier(.4,0,.2,1);transform:scale(1);opacity:.8;flex-shrink:0}.carousel-dots__dot--active[_ngcontent-%COMP%]{width:16px;border-radius:6px;background:linear-gradient(93.89deg,#ff9d00,#ff5100);transform:scale(1.1);opacity:1}.carousel-inner[_ngcontent-%COMP%] > *[pCarouselItem][_ngcontent-%COMP%]:last-child{scroll-snap-align:end}"],changeDetection:0});var Zt=T;export{$t as a,Bt as b,X as c,Zt as d};
